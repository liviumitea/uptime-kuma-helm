apiVersion: v1
kind: Pod
metadata:
  name: "{{ include "uptime-kuma.fullname" . }}-test-connection"
  namespace: {{ include "uptime-kuma.namespace" . }}
  labels:
    {{- include "uptime-kuma.labels" . | nindent 4 }}
  annotations:
    "helm.sh/hook": test
spec:
  restartPolicy: Never
  containers:
    - name: wget
      image: busybox
      # run 'wget -qO- http://<svc-name>:<port>' and exit non-zero if not 200
      command: ["wget"]
      args:
        - "-qO-"
        - "http://{{ include "uptime-kuma.fullname" . }}:{{ (index .Values.service.ports 0).port }}"
